define(["jquery","photoswipe","underscore"],function(e,t,t){var n=function(e){this.options=e};return n.prototype.instantiate=function(e){this.images=e;var t=this,n=window.Code.PhotoSwipe;this.instance=n.attach(e,this.options),this.instance.addEventHandler(n.EventTypes.onDisplayImage,function(e){var n=t.instance.getCurrentImage();console.log(n),t.setImageData(n.metaData.id)})},n.prototype.show=function(e){typeof e=="function"&&(e=_.find(this.images,e)),e=e?e:0,this.instance.show(e)},n.prototype.destroy=function(){var e=this.instance;window.Code.PhotoSwipe.unsetActivateInstance(e),window.Code.PhotoSwipe.detatch(e)},n.prototype.setImageData=function(t){e(".ps-caption-content").html(""),e(".artwork-info-wrapper").html(""),e(".artwork-info-spinner").animate({opacity:1},300);var n=this._getArtworkData(t);n.done(function(t,n,r){console.log("single request answered"),console.log(t),t.price&&e(".ps-caption-content").html("R$ "+t.price);var i=t.artist.title;t.observations&&(i+=" - "+t.observations),e(".artwork-info-wrapper").html(i)}),n.fail(function(t,n,r){e(".ps-caption-content").html("---"),e(".artwork-info-wrapper").html("---")}),n.always(function(t,n,r){e(".artwork-info-spinner").animate({opacity:0},300)})},n.prototype._getArtworkData=function(t){var n=e.ajax({url:CONFIG.restEndpoint,type:"GET",dataType:"json",data:{request:"single",id:t},cache:!1});return n},n});